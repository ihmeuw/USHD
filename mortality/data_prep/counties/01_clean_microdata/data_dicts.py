##-----------------------------------------------------------------------------------------------------
## Description: All NVSS data is stored in fixed-width file formats, but the encoding of those files 
##				(i.e. which variables are stored where on each row) changes from year to year. These 
##				dicts identify the variables of interest in each file, and map their positions for extraction.
##				At the bottom of the script is a function (give_data_dict()) that takes in a year value and 
##				returns the appropriate dict.
##
## Full documentation can be found here:
## 			1959-1990 available at: http://www.nber.org/data/vital-statistics-mortality-data-multiple-cause-of-death.html 
##			1991-2001 available at: http://www.cdc.gov/nchs/nvss/mortality_public_use_data.htm
## 			2002-2006 available in the respective year's folder in FILEPATH
## 			2007 onward not available for specific years, but the documentation in the appropriate folders suggests that format is the same as 2005's. 
## 

##		  corresponds to the latest dict (currently labeled data_dict_2003_2014). If it does correspond, you can 
##		  simply update that dict (e.g. to data_dict_2003_2015) and increment the ranges in the yeardict variable
##		  of the give_data_dict() function at the bottom of the script. If the data does not correspond to the latest
##		  dict, you must write a new dict and update give_data_dict() appropriately.
##-----------------------------------------------------------------------------------------------------------------

import BetweenDict as bd

data_dict_1959_1961 = {
'rec_type'		:	[8, 9],
'res_status'	: 	[9, 10],
'month_death'	:	[4, 6],
'state_occ_NONFIPS'	:	[19, 21],
'state_res_NONFIPS'	: 	[30, 32],
'sex'			:	[46, 47],
'race'			: 	[41, 43],
'age'			:	[47, 50],
'cause'			:	[71, 75],
}

data_dict_1962_1967 = {
'rec_type'		:	[8, 9],
'res_status'	: 	[9, 10],
'month_death'	:	[4, 6],
'state_occ_NONFIPS'	:	[17, 19],
'county_occ_NONFIPS'	:	[19, 22], 
'state_res_NONFIPS'	: 	[28, 30],
'county_res_NONFIPS'	:	[30, 33], 
'sex'			:	[46, 47],
'race'			: 	[41, 43],
'age'			:	[47, 50],
'cause'			:	[71, 75],
}

data_dict_1968_1978 = {
'rec_type'		:	[10, 11],
'res_status'	: 	[11, 12],
'month_death'	:	[30, 32],
'state_occ_NONFIPS'	:	[25, 27],
'county_occ_NONFIPS'	:	[27, 30],
'state_res_NONFIPS'	: 	[12, 14],
'county_res_NONFIPS'	:	[14, 17],
'sex'			:	[34, 35],
'race'			: 	[35, 36],
'age'			:	[38, 41],
'cause'			:	[59, 63],
'place_injury'	:	[90, 91],
'number_entities':	[98, 100],
'entity_1'		:	[100, 108],
'entity_2'		:	[108, 116],
'entity_3'		:	[116, 124],
'entity_4'		:	[124, 132],
'entity_5'		:	[132, 140],
'entity_6'		:	[140, 148],
'entity_7'		:	[148, 156],
'entity_8'		:	[156, 164],
'entity_9'		:	[164, 172],
'entity_10'		:	[172, 180],
'entity_11'		:	[180, 188],
'entity_12'		:	[188, 196],
'entity_13'		:	[196, 204],
'entity_14'		:	[204, 212]
}

 
data_dict_1979_1981 = {
'reporting_area':	[2,3],
'rec_type'		:	[18, 19],
'res_status'	: 	[19, 20],
'month_death'	:	[54, 56],
'state_occ_NONFIPS'	:	[20, 22],
'county_occ_NONFIPS'	:	[22, 25],
'state_res_NONFIPS'	: 	[30, 32],
'county_res_NONFIPS'	:	[32, 35],
'sex'			:	[58, 59],
'race'			: 	[59, 61],
'race_recode_3' :   [61, 62],
'race_recode_2' :   [62, 63],
'age'			:	[63, 66],
'marital'		:	[76, 77],
'cause'			:	[141, 145],
'place_injury'	:	[140, 141],
'number_entities':	[159, 161],
'entity_1'		:	[161, 168],
'entity_2'		:	[168, 175],
'entity_3'		:	[175, 182],
'entity_4'		:	[182, 189],
'entity_5'		:	[189, 196],
'entity_6'		:	[196, 203],
'entity_7'		:	[203, 210],
'entity_8'		:	[210, 217],
'entity_9'		:	[217, 224],
'entity_10'		:	[224, 231],
'entity_11'		:	[231, 238],
'entity_12'		:	[238, 245],
'entity_13'		:	[245, 252],
'entity_14'		:	[252, 259],
'entity_15'		:	[259, 266],
'entity_16'		:	[266, 273],
'entity_17'		:	[273, 280],
'entity_18'		:	[280, 287],
'entity_19'		:	[287, 294],
'entity_20'		:	[294, 301]
}

data_dict_1982_1983 = {
'rec_type'		:	[18, 19],
'res_status'	: 	[19, 20],
'month_death'	:	[54, 56],
'state_occ_numeric'	:  [118, 120],
'county_occ'	:	[120, 123],
'state_res_numeric'	: 	[123, 125],
'county_res'	:	[125, 128],
'full_fips_res_numeric': [123, 128],
'sex'			:	[58, 59],
'race'			: 	[59, 61],
'race_recode_3' :   [61, 62],
'race_recode_2' :   [62, 63],
'age'			:	[63, 66],
'marital'		:	[76, 77],
'cause'			:	[141, 145],
'place_injury'	:	[140, 141],
'number_entities':	[159, 161],
'entity_1'		:	[161, 168],
'entity_2'		:	[168, 175],
'entity_3'		:	[175, 182],
'entity_4'		:	[182, 189],
'entity_5'		:	[189, 196],
'entity_6'		:	[196, 203],
'entity_7'		:	[203, 210],
'entity_8'		:	[210, 217],
'entity_9'		:	[217, 224],
'entity_10'		:	[224, 231],
'entity_11'		:	[231, 238],
'entity_12'		:	[238, 245],
'entity_13'		:	[245, 252],
'entity_14'		:	[252, 259],
'entity_15'		:	[259, 266],
'entity_16'		:	[266, 273],
'entity_17'		:	[273, 280],
'entity_18'		:	[280, 287],
'entity_19'		:	[287, 294],
'entity_20'		:	[294, 301]
}


data_dict_1984_1991 = {
'rec_type'		:	[18, 19],
'res_status'	: 	[19, 20],
'month_death'	:	[54, 56],
'state_occ_numeric'	:	[118, 120],
'county_occ'	:	[120, 123],
'state_res_numeric'	: 	[123, 125],
'county_res'	:	[125, 128],
'full_fips_res_numeric' : [123, 128],
'pmsa_res'		: 	[128, 132], 
'cmsa_res'		: 	[133, 135],
'sex'			:	[58, 59],
'race'			: 	[59, 61],
'race_recode_3' :   [61, 62],
'race_recode_2' :   [62, 63],
'age'			:	[63, 66],
'marital'		:	[76, 77],
'hisp_desc'		:	[79, 81],
'hisp_recode'	:	[81, 82],
'education'		:	[51, 53],
'industry'		:	[84, 87],
'industry_recode':	[93, 95],
'occupation'	:	[87, 90],
'occupation_recode':[97, 99],
'cause'			:	[141, 145],
'injury_at_work':	[135, 136],
'place_injury'	:	[140, 141],
'manner_of_death':	[137, 138],
'activity_code'	:	[139, 140],
#'entities'		:	[159, 301]
'number_entities':	[159, 161],
'entity_1'		:	[161, 168],
'entity_2'		:	[168, 175],
'entity_3'		:	[175, 182],
'entity_4'		:	[182, 189],
'entity_5'		:	[189, 196],
'entity_6'		:	[196, 203],
'entity_7'		:	[203, 210],
'entity_8'		:	[210, 217],
'entity_9'		:	[217, 224],
'entity_10'		:	[224, 231],
'entity_11'		:	[231, 238],
'entity_12'		:	[238, 245],
'entity_13'		:	[245, 252],
'entity_14'		:	[252, 259],
'entity_15'		:	[259, 266],
'entity_16'		:	[266, 273],
'entity_17'		:	[273, 280],
'entity_18'		:	[280, 287],
'entity_19'		:	[287, 294],
'entity_20'		:	[294, 301],
'record_num'	:	[337, 339]
}

data_dict_1992_2002 = {
'rec_type'		:	[18, 19],
'res_status'	: 	[19, 20],
'month_death'	:	[54, 56],
'state_occ_numeric'	:	[118, 120],
'county_occ'	:	[120, 123],
'state_res_numeric'	: 	[123, 125],
'county_res'	:	[125, 128],
'full_fips_res_numeric' : [123, 128],
'pmsa_res'		: 	[128, 132], 
'cmsa_res'		: 	[133, 135],
'sex'			:	[58, 59],
'race'			: 	[59, 61],
'race_recode_3' :   [61, 62],
'race_recode_2' :   [62, 63],
'race_imputation' : [136, 137],
'age'			:	[63, 66],
'marital'		:	[76, 77],
'hisp_desc'		:	[79, 81],
'hisp_recode'	:	[81, 82],
'education'		:	[51, 53],
'industry'		:	[84, 87],
'occupation'	:	[87, 90],
'cause'			:	[141, 145],
'injury_at_work':	[135, 136],
'place_injury'	:	[140, 141],
'manner_of_death':	[137, 138],
'activity_code'	:	[139, 140],
'number_entities':	[159, 161],
'entity_1'		:	[161, 168],
'entity_2'		:	[168, 175],
'entity_3'		:	[175, 182],
'entity_4'		:	[182, 189],
'entity_5'		:	[189, 196],
'entity_6'		:	[196, 203],
'entity_7'		:	[203, 210],
'entity_8'		:	[210, 217],
'entity_9'		:	[217, 224],
'entity_10'		:	[224, 231],
'entity_11'		:	[231, 238],
'entity_12'		:	[238, 245],
'entity_13'		:	[245, 252],
'entity_14'		:	[252, 259],
'entity_15'		:	[259, 266],
'entity_16'		:	[266, 273],
'entity_17'		:	[273, 280],
'entity_18'		:	[280, 287],
'entity_19'		:	[287, 294],
'entity_20'		:	[294, 301],
'record_num'	:	[337, 339],
'record_num'	:	[337, 339]
}

data_dict_2003_2010 = {
'year'			:	[101, 105],
'rec_type'		:	[18, 19],
'res_status'	: 	[19, 20],
'month_death'	:	[64, 66],
'state_occ_alpha':	[20, 22],
'county_occ'	 :	[22, 25],
'state_res_alpha': 	[28, 30],
'county_res'	:	[34, 37],
'pmsa_res'		: 	[46, 50],
'cmsa_res'		: 	[52, 54],
'sex'			:	[68, 69],
'race'			: 	[444, 446],
'race_recode_3' :   [448, 449],
'race_recode_5' :   [449, 450],
'race_imputation' : [447, 448],
'race_bridged'  :   [446, 447],
'age'			:	[69, 73],
'marital'		:	[83, 84],
'hisp_desc'		:	[483, 486],
'hisp_recode'	:	[487, 488],
'edu_1989'		:	[60, 62],
'edu_2003' 		: 	[62, 63],
'edu_flag'		:	[63, 64],
'cause'			:	[145, 149],
'injury_at_work':	[105, 106],
'place_injury'	:	[144, 145],
'manner_of_death':	[106, 107],
'activity_code'	:	[143, 144],
'number_entities':	[162, 164],
'entity_1'		:	[164, 171],
'entity_2'		:	[171, 178],
'entity_3'		:	[178, 185],
'entity_4'		:	[185, 192],
'entity_5'		:	[192, 199],
'entity_6'		:	[199, 206],
'entity_7'		:	[206, 213],
'entity_8'		:	[213, 220],
'entity_9'		:	[220, 227],
'entity_10'		:	[227, 234],
'entity_11'		:	[234, 241],
'entity_12'		:	[241, 248],
'entity_13'		:	[248, 255],
'entity_14'		:	[255, 262],
'entity_15'		:	[262, 269],
'entity_16'		:	[269, 276],
'entity_17'		:	[276, 283],
'entity_18'		:	[283, 290],
'entity_19'		:	[290, 297],
'entity_20'		:	[297, 304],
'record_num'	:	[340, 342]
}

data_dict_2011_2020 = {
'year'			:	[101, 105],
'rec_type'		:	[18, 19],
'res_status'	: 	[19, 20],
'month_death'	:	[64, 66],
'state_occ_alpha':	[20, 22],
'county_occ'	 :	[22, 25],
'state_res_alpha': 	[28, 30],
'county_res'	:	[34, 37],
'pmsa_res'		: 	[46, 50], 
'cmsa_res'		: 	[52, 54],
'sex'			:	[68, 69],
'race'			: 	[444, 446],
'race_recode_3' :   [448, 449],
'race_recode_5' :   [449, 450],
'race_recode_40' :  [488, 490],
'race_imputation' : [447, 448],
'race_bridged'  :   [446, 447],
'age'			:	[69, 73],
'marital'		:	[83, 84],
'hisp_desc'		:	[483, 486],
'hisp_recode'	:	[487, 488],
'edu_1989'		:	[60, 62],
'edu_2003' 		: 	[62, 63],
'edu_flag'		:	[63, 64],
'cause'			:	[145, 149],
'injury_at_work':	[105, 106],
'place_injury'	:	[144, 145],
'manner_of_death':	[106, 107],
'activity_code'	:	[143, 144],
'number_entities':	[162, 164],
'entity_1'		:	[164, 171],
'entity_2'		:	[171, 178],
'entity_3'		:	[178, 185],
'entity_4'		:	[185, 192],
'entity_5'		:	[192, 199],
'entity_6'		:	[199, 206],
'entity_7'		:	[206, 213],
'entity_8'		:	[213, 220],
'entity_9'		:	[220, 227],
'entity_10'		:	[227, 234],
'entity_11'		:	[234, 241],
'entity_12'		:	[241, 248],
'entity_13'		:	[248, 255],
'entity_14'		:	[255, 262],
'entity_15'		:	[262, 269],
'entity_16'		:	[269, 276],
'entity_17'		:	[276, 283],
'entity_18'		:	[283, 290],
'entity_19'		:	[290, 297],
'entity_20'		:	[297, 304],
'record_num'	:	[340, 342]
}

def give_data_dict(year):
	yeardict = {
	(1959, 1962): (1959, 1961),
	(1962, 1968): (1962, 1967),
	(1968, 1979): (1968, 1978),
	(1979, 1982): (1979, 1981),
	(1982, 1984): (1982, 1983),
	(1984, 1992): (1984, 1991),
	(1992, 2003): (1992, 2002),
	(2003, 2011): (2003, 2010),
	(2011, 2021): (2011, 2020)
	}

	yearmap = bd.BetweenDict(yeardict)
	yearvals = yearmap[year]

	dict_str = 'data_dict_%d_%d' %(yearvals[0], yearvals[1])
	data_dict = eval(dict_str)

	return data_dict
